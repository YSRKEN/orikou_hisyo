おりこうさんな秘書 Ver.1.3
※等幅フォントで表示することを推奨します
--------------------------------------------------------------------------------
[ソフト紹介]
　このソフトウェアは、艦これの画面を常に監視しつつ、要所要所でスクショを自動で
撮ってくれるソフトです。これにより、いつでも母港画面や編成画面や戦果報告などを
確認できるようになるので、例えば次のような用途に役立ちます。
　・戦果報告を適当にクリックで飛ばしたから大破してないかが分からない場合に、
　　遡って確認することが出来る。大破進軍、ダメ・ゼッタイ！
　・艦隊の編成や装備も確認できるので、進軍中でも遠征に出した編成をサッと見られる
　・名前隠し機能もあるので、スクショでうっかり提督名を晒してしまうこともない
　また特殊な機能として、次のような機能も実装しています。
　・改装画面でのスクショを利用した「装備まとめ画像作成機能」
　・母港・マップ・戦闘画面において「BGMを自動で流せる機能」
　・必要経験値や周回数を計算する「経験値計算機」
　・入渠画面を画像で読み取り、自動でカウントする「入渠タイマー」

[インストール・アンインストール方法]
・インストール方法
　zipファイルを解凍するだけです。
・アンインストール方法
　ファイルをそのまま削除するだけです。レジストリは使用しません。

[ファイル]
☆orikou13.exe……実行ファイル
☆assist.exe……文字認識用ツール
☆hspcv.dll liblept168.dll libtesseract302.dll
　……動作に必要なライブラリ
☆cursor.png……カーソルアイコン画像(自作)
☆tessdataフォルダ……文字認識に必要なデータファイル群
・Readme.txt……この文書のこと
・sourceフォルダ
　・orikou13.hsp……本体のソースコード
　・area_exp.txt……マップ経験値一覧
　・exp_table.txt……レベル―経験値対応表
　・assistフォルダ……文字認識用ツールのソースコード
※ソフト自体の動作には、☆の付いたものだけで十分です

[操作方法]
1.　実行すると、次の2つのウィンドウが表示されます。
　　・縦長の小さなウィンドウ(メイン画面。常に最前面)
　　・800x480の大きなウィンドウ(サブ画面。特に最前面ではない)

2.　どのウィンドウも艦これの画面を隠さないようにしてから、まずは「座標取得」
　ボタンを押してください。すると、艦これの画面の位置が判定されます。
　　ここでFlashのサイズは、ブラウザの表示設定で「100％」表示にしてください。
　　判定方法は次の2つがあります。
　　"自動設定"……モニタ全体のスクショから検索
　　"手動設定"……手動で検索範囲を指定する。こちらの場合、モニタ全体をキャプチャ
　　　　　　　　　した上でマウスで選択させます。なお、Escキーで中断はEscキーです。

3.　サブ画面のタイトルバーには、次の形式で情報が示されています。
　　　『ソフト名 - 表示モード - (艦これの座標) - 認識結果』
　　・表示モード……メイン画面の「現在状況」〜「戦果報告」、「編成画面」、
　　　　　　　　　　「改装画面」をクリックすると変更されます。
　　・艦これの座標……艦これの画面の左上のことを指します。
　　　　　　　　　　　初期値は(0,0)ですが、座標取得することで変更されます。
　　・認識結果……現在の艦これFlashの状況を示すためのものです。
　　　　　　　　　表示モードに対応するものがない場合は全て「不明」と表示されます。

4.　認識結果が「不明」以外の場合、それぞれ最後に表示された内容が記録されます。
　　・現在状況……その瞬間に、艦これの画面に表示されている場面
　　・母港画面……秘書艦と6つの大きな歯車が鎮座している場面
　　・戦績表示……提督経験値、最大保有可能数等が表示されている場面
　　・入渠画面……入渠ドックの画面。通常閲覧時、リスト表示時、詳細表示時に対応
　　・工廠画面……ドックの表示の他、開発・建造前の数値入力画面にも対応
　　・マップ画面……海域に出撃してからの道中(羅針盤部分)を指す
　　・戦闘画面……昼戦・夜戦に両対応
　　・中大破画像……中破か大破した際の画像
　　・交戦結果……戦闘終了直後の、敵味方の損害状況が表示された場面
　　・戦果報告……MVPが表示されている場面。大破チェック(後述)はこの際働く
　　・編成画面、改装画面……第1〜第4艦隊まで対応

5.　サブ画面の表示は表示モードに従うので、例えば次の用途に使えます。
　　・進軍選択の際、うっかり戦果報告を見逃しても大破してないかを確認可能
　　・マップ画面も見返せるので、どのマスまで進軍したかも確認可能
　　・現在の艦隊の編成・装備をサーバーに負担が掛からずに確認できる

6.　「【画像保存】」ボタンと、「【○○艦隊】」ボタンは、どちらも
　exeと同じフォルダに画像を保存する機能です。この際ファイル名は、現在日時＋連番
　で記憶されるので、連打しても上書きはされません。違いとしては次の通りです。
　　・【画像保存】
　　　　現在サブ画面に表示されている内容をそのまま保存します。名前隠し(後述)の
　　　状態も反映されますので、スレに貼る時などに有効でしょう。
　　・【○○艦隊】
　　　　このボタンの左にある内容(第1〜第4艦隊、連合艦隊、支援艦隊)に従い、
　　　編成まとめ画像(艦娘の状態と装備をまとめたもの)を自動作成して保存します。
　　　　要するに、改装画面からパラパラと各艦娘を確認してからこのボタンを押せば
　　　すぐにまとめ画像が作成できるわけです。

7.　「経験値計算」ボタンを押すと、経験値計算機の画面が現れます。
　　要するにレベル・海域・勝利状況・オプションを設定すれば自動的に
　　必要な周回数などを計算してくれる、といったものです。
　　もちろん、「閉じる」ボタンを押せば画面は閉じられます。

8.　「入渠タイマー」ボタンを押すと、入渠タイマーの画面が現れます。
　　艦これの画面で入渠画面を表示させた状態で「更新」ボタンを押すと、
　　入渠画面から残り時間を自動で読み取った上で、残り時間と終了予定時刻を
　　表示してくれます。勿論、一度更新すると、艦これの画面を入渠画面から
　　切り替えてもカウントは続行されます。

9.　「○号カウンター」ボタンを押すと、あ号・い号・ろ号作戦用のカウンターが現れます。
　　使い方は見たまんまですが、リセットボタンを押すと全部リセットされるのでご注意を。

10.　以下、他のチェックボックス等について説明します。
　　・大破チェック
　　　　戦果報告の画面で大破艦が存在していた場合、ダイアログで
　　　警告メッセージが表示されます。大破進撃は「ダメ・ゼッタイ」！
　　　　ちなみにこのダイアログは、艦これが戦果報告の画面である限り何度でも
　　　出続けますので、消したい人はチェックを外すか進撃選択画面に移動して下さい。
　　・名前隠し
　　　母港・戦績・戦果等の場面で提督名を隠す機能です。
　　・倍率〜％
　　　　サブ画面のサイズを変更できる機能です。200・150・100・75・50％表示に
　　　することができます。なお、画像保存時は800x480固定なので注意！
　　・〜〜BGM
　　　　母港(ここではマップ画面と戦闘画面以外という意味)と
　　　マップ画面と戦闘画面で好きなBGMを流せる機能です。
　　　　読み込まれる音声ファイルはWAVとMP3とWMAのみとなります。
　　　「参照...」ボタンで読み込んだ際に、その内容が更新されます。
　　　　本当は別のシーンに遷移するorチェックを外すと勝手に止まるはずですが、
　　　止まらない場合は「BGM停止」ボタンを押して下さい。また、鳴らない場合は、
　　　　チェックをON/OFFして入れなおして下さい。
　　・カーソル
　　　　サブ画面にマウスカーソルを表示できます(画像保存時は写りません)。
　　　　表示画像はcursor.pngを差し替えれば何でも表示できますが、その際は
　　　(255,0,0)が透明色なのでご注意下さい。
　　・〜fps
　　　　画像を取得する更新頻度を変更できます。デフォルトでは30fpsですが、
　　　下げることで負荷を軽減できます。なお、1〜30fpsまで対応しています。

11.　「情報」ボタンを押すと、バージョン情報が表示されます。

[内部処理の説明]
　アルゴリズムとしては、WinAPIでスクショ撮影→画像認識でシーン判断→
用意したバッファに自動保存、となります。画像認識とは言っても、相当簡略化してる
ので認識に失敗することもあるかもしれません。艦これのswfを解析して認識用データに
使用してる、なんてことは一切ありませんのでご心配なく。
　それと、入渠タイマーでの画像認識は、Tesseract-OCRに丸投げしています。
その際、受け渡しするために「temp.png」というファイルを何度か作成しますので、
書き込みできないドライブ上で入渠タイマーを使おうとするとエラーが出ることが……。
　なお、ブラウザが100％表示の時以外に使えないのも認識アルゴリズムの仕様です。

[注意]
・原理がスクショ＋画像認識だから、コマンドを送りつけるマクロ・BOTや、プロキシで
　通信を拾う専ブラとは別物です！

・バグでスクショが上手く記録されてなかったりとかする可能性もありますので、
　その辺は自己責任でご使用ください。

・上にも書きましたが、100％表示(800x480の画面)だけを認識するので、ブラウザ側で
　下手に拡大縮小すると艦これの画面だと認識されません。また、マルチディスプレイ
　環境の場合は、メインディスプレイに艦これの画面を置かないと認識されないので
　注意しましょう。ただ、このソフト自体はどこのウィンドウに置いても構いません。

・画像保存機能を使う都合上、ソフトウェア自体の権限に注意しましょう。最近はUACや
　Windows SmartScreenなどが標準で動いている上、セキュリティソフトが自動で監視
　している場合がありますので、警告ダイアログに阻まれたりすることがあります……。
　また、入渠タイマーは、書き込み可能なドライブ上じゃないと使えません。

・自動更新する間隔を下げると、当然負荷は下がりますが、決定的瞬間を取り逃す
　リスクも増えるかもしれません(特に「中大破画像」などは)

・おりこうさん本体のソースコードは「Hot Soup Processor」という言語で記述されています。
　また、assist.exeはVisual Studio 2013でコンパイルされました。
　(VS2013でもXP以降で動かせるようにコンパイルは出来ますが、XPでの動作確認は流石に……)

[使用ライブラリ]
・Tesseract-OCR Ver.3.02.02 (Apache License 2.0)
　https://code.google.com/p/tesseract-ocr/
・Leptonica Ver.1.68
　(Dan Bloomberg氏によりCreative Commons Attribution 3.0
　United States Licenseでライセンスされている)
　http://www.leptonica.com/index.html

[謝辞]
「艦これ一覧めいかー」
　(kanahiron氏、http://www.vector.co.jp/soft/winnt/game/se508332.html)
「赤城さんのお風呂タイマー」
　(Satofumi Kamimura氏、https://sites.google.com/site/bathtimer/)
「HSP-NEXT」
　(sakura氏、http://hspnext.com/index.html)
「Advanced HSP」
　(ちょくと氏、http://chokuto.ifdef.jp/advanced/index.html)
「Let's HSP!」
　(Kpan氏、http://lhsp.s206.xrea.com/)
「プログラミング工房」
　(chrono氏、http://lldev.jp/index.html)
この方々がいなければこのソフトウェアは生まれませんでした。深く感謝いたします。

[更新履歴]
＜Ver.1.3(2015/02/23)＞
・サブ画面のマウスカーソル表示を、現在状況モードのみに限定した。
・サブ画面に表示されてるのが入渠画面でない時に入渠タイマーが使えないのを修正した。
・○○艦隊保存機能でのファイルパスがおかしかったのを修正した。
・演習一覧・演習個別の記録に対応した。
・Tesseract-OCRを利用して文字認識の精度を上げた。
・上記の機能を追加するために、ボタン等を少しだけ小さくした。

＜Ver.1.2(2015/02/19)＞
・サブ画面の更新頻度を1〜30fpsまで調整できるようにした。
・サブ画面にマウスカーソルを表示させられるようにするオプションを付けた。

＜Ver1.1(2015/02/18)＞
・【画像保存】ボタンで、保存される画像のサイズが「倍率〜〜％」に影響されない
　ようにした。これにより、文字が潰れずに安心して保存できるようになった。
・「倍率〜〜％」に拡大の方も実装した。大きなディスプレイでもこれで安心？
・中破・大破した際の画像も自動記録できるようにした。
・経験値計算機と入渠タイマーを追加実装した。

・Ver1.0(2015/02/15)
　初版。

[著作権]
【  ソフト名  】おりこうさんな秘書 Ver.1.3
【    種別    】フリーウェア
【    種類    】ユーティリティ
【   開発者   】YSR
【  動作環境  】Microsoft Windows 98,Me,2000,XP(NT4.0以降を含む),Vista,7,8,8.1
【  開発言語  】Hot Soup Processor ver.3.4beta
【   連絡先   】ysr.ken@gmail.com
【  Webページ 】http://www.vector.co.jp/vpack/browse/person/an050622.html
【    転載    】自由です。ただし、私の名前も一緒に乗せてください。
　このソフトに対する意見や感想、バグ報告等がありましたら、こちらに連絡してくださ
い。より良いソフトウェア作りに役立てたいと思います。

[コメント]
　でち有能！イムヤデコイ！イクエロい！はっちゃん有能！まるゆ△！
ゆーちゃんカワイイヤッター！‥…しおいはまだいないよ！！
